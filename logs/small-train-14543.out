Loading model: data/model/meta-llama/llama-3.1-8B-instruct
Using device: cuda
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.0424
Loading dataset from data/training_data.jsonl
Starting training...
{'loss': 2.0977, 'grad_norm': 6.755253314971924, 'learning_rate': 0.000199, 'epoch': 0.36}
{'loss': 1.8719, 'grad_norm': 2.779508352279663, 'learning_rate': 0.00019757142857142857, 'epoch': 0.71}
{'loss': 1.4218, 'grad_norm': 5.804455757141113, 'learning_rate': 0.00019614285714285716, 'epoch': 1.07}
{'loss': 1.2311, 'grad_norm': 3.187688112258911, 'learning_rate': 0.00019471428571428572, 'epoch': 1.43}
{'loss': 1.2774, 'grad_norm': nan, 'learning_rate': 0.00019328571428571428, 'epoch': 1.79}
{'loss': 1.1213, 'grad_norm': 3.256728410720825, 'learning_rate': 0.000192, 'epoch': 2.14}
{'loss': 0.9184, 'grad_norm': 6.86159086227417, 'learning_rate': 0.0001905714285714286, 'epoch': 2.5}
{'loss': 0.95, 'grad_norm': 5.26645040512085, 'learning_rate': 0.00018914285714285715, 'epoch': 2.86}
{'loss': 0.7839, 'grad_norm': 4.99605131149292, 'learning_rate': 0.00018771428571428574, 'epoch': 3.21}
{'loss': 0.6909, 'grad_norm': 19.62123680114746, 'learning_rate': 0.0001862857142857143, 'epoch': 3.57}
{'loss': 0.6409, 'grad_norm': 5.592828273773193, 'learning_rate': 0.00018485714285714286, 'epoch': 3.93}
{'loss': 0.411, 'grad_norm': 2.5226900577545166, 'learning_rate': 0.00018342857142857145, 'epoch': 4.29}
{'loss': 0.5258, 'grad_norm': 5.986091136932373, 'learning_rate': 0.000182, 'epoch': 4.64}
{'loss': 0.4467, 'grad_norm': 5.511806964874268, 'learning_rate': 0.00018057142857142857, 'epoch': 5.0}
{'loss': 0.2728, 'grad_norm': 12.28065013885498, 'learning_rate': 0.00017914285714285715, 'epoch': 5.36}
{'loss': 0.3461, 'grad_norm': 6.565855979919434, 'learning_rate': 0.0001777142857142857, 'epoch': 5.71}
{'loss': 0.249, 'grad_norm': 20.852001190185547, 'learning_rate': 0.0001762857142857143, 'epoch': 6.07}
{'loss': 0.2368, 'grad_norm': 15.909209251403809, 'learning_rate': 0.0001748571428571429, 'epoch': 6.43}
{'loss': 0.1653, 'grad_norm': 4.331399917602539, 'learning_rate': 0.00017342857142857142, 'epoch': 6.79}
{'loss': 0.2527, 'grad_norm': 6.1920952796936035, 'learning_rate': 0.000172, 'epoch': 7.14}
{'loss': 0.1628, 'grad_norm': 10.24538803100586, 'learning_rate': 0.0001705714285714286, 'epoch': 7.5}
{'loss': 0.1288, 'grad_norm': 7.85920524597168, 'learning_rate': 0.00016914285714285715, 'epoch': 7.86}
{'loss': 0.1496, 'grad_norm': 5.547978401184082, 'learning_rate': 0.0001677142857142857, 'epoch': 8.21}
{'loss': 0.1073, 'grad_norm': 4.8067474365234375, 'learning_rate': 0.0001662857142857143, 'epoch': 8.57}
{'loss': 0.1454, 'grad_norm': 5.844265460968018, 'learning_rate': 0.00016485714285714286, 'epoch': 8.93}
{'loss': 0.1382, 'grad_norm': 9.871935844421387, 'learning_rate': 0.00016342857142857145, 'epoch': 9.29}
{'loss': 0.1004, 'grad_norm': 2.4605541229248047, 'learning_rate': 0.000162, 'epoch': 9.64}
{'loss': 0.1064, 'grad_norm': 2.7900633811950684, 'learning_rate': 0.00016057142857142857, 'epoch': 10.0}
{'loss': 0.0878, 'grad_norm': 4.467132568359375, 'learning_rate': 0.00015914285714285715, 'epoch': 10.36}
{'loss': 0.0997, 'grad_norm': 0.9197660684585571, 'learning_rate': 0.00015771428571428571, 'epoch': 10.71}
{'loss': 0.0726, 'grad_norm': 2.0826635360717773, 'learning_rate': 0.0001562857142857143, 'epoch': 11.07}
{'loss': 0.051, 'grad_norm': 10.202874183654785, 'learning_rate': 0.00015485714285714286, 'epoch': 11.43}
{'loss': 0.0707, 'grad_norm': 8.824356079101562, 'learning_rate': 0.00015342857142857142, 'epoch': 11.79}
{'loss': 0.067, 'grad_norm': 1.2936381101608276, 'learning_rate': 0.000152, 'epoch': 12.14}
{'loss': 0.086, 'grad_norm': 4.145094871520996, 'learning_rate': 0.0001505714285714286, 'epoch': 12.5}
{'loss': 0.061, 'grad_norm': 7.015532970428467, 'learning_rate': 0.00014914285714285713, 'epoch': 12.86}
{'loss': 0.0714, 'grad_norm': 1.0233328342437744, 'learning_rate': 0.00014771428571428572, 'epoch': 13.21}
{'loss': 0.0673, 'grad_norm': 2.643676519393921, 'learning_rate': 0.0001462857142857143, 'epoch': 13.57}
{'loss': 0.0741, 'grad_norm': 4.907759666442871, 'learning_rate': 0.00014485714285714286, 'epoch': 13.93}
{'loss': 0.0596, 'grad_norm': 0.49479350447654724, 'learning_rate': 0.00014342857142857145, 'epoch': 14.29}
{'loss': 0.0598, 'grad_norm': 9.368854522705078, 'learning_rate': 0.000142, 'epoch': 14.64}
{'loss': 0.058, 'grad_norm': 3.640538454055786, 'learning_rate': 0.00014057142857142857, 'epoch': 15.0}
{'loss': 0.0501, 'grad_norm': 3.4319887161254883, 'learning_rate': 0.00013914285714285716, 'epoch': 15.36}
{'loss': 0.0573, 'grad_norm': 0.5016728639602661, 'learning_rate': 0.00013771428571428572, 'epoch': 15.71}
{'loss': 0.0525, 'grad_norm': 0.3378011882305145, 'learning_rate': 0.00013628571428571428, 'epoch': 16.07}
{'loss': 0.0469, 'grad_norm': 1.8568872213363647, 'learning_rate': 0.00013485714285714286, 'epoch': 16.43}
{'loss': 0.0568, 'grad_norm': 1.4596209526062012, 'learning_rate': 0.00013342857142857142, 'epoch': 16.79}
{'loss': 0.0498, 'grad_norm': 1.5749684572219849, 'learning_rate': 0.000132, 'epoch': 17.14}
{'loss': 0.0488, 'grad_norm': 0.6504979729652405, 'learning_rate': 0.00013057142857142857, 'epoch': 17.5}
{'loss': 0.0704, 'grad_norm': 0.5311704277992249, 'learning_rate': 0.00012914285714285713, 'epoch': 17.86}
{'loss': 0.0511, 'grad_norm': 0.4429681599140167, 'learning_rate': 0.00012771428571428572, 'epoch': 18.21}
{'loss': 0.0491, 'grad_norm': 2.438666582107544, 'learning_rate': 0.0001262857142857143, 'epoch': 18.57}
{'loss': 0.0515, 'grad_norm': 0.40782827138900757, 'learning_rate': 0.00012485714285714286, 'epoch': 18.93}
{'loss': 0.0399, 'grad_norm': 4.088993549346924, 'learning_rate': 0.00012342857142857142, 'epoch': 19.29}
{'loss': 0.0454, 'grad_norm': 3.5363731384277344, 'learning_rate': 0.000122, 'epoch': 19.64}
{'loss': 0.0539, 'grad_norm': 0.36609014868736267, 'learning_rate': 0.00012057142857142858, 'epoch': 20.0}
{'loss': 0.0335, 'grad_norm': 0.2854711413383484, 'learning_rate': 0.00011914285714285716, 'epoch': 20.36}
{'loss': 0.0456, 'grad_norm': 0.4512918293476105, 'learning_rate': 0.0001177142857142857, 'epoch': 20.71}
{'loss': 0.0438, 'grad_norm': 0.4486813247203827, 'learning_rate': 0.00011628571428571429, 'epoch': 21.07}
{'loss': 0.0273, 'grad_norm': 0.3654469847679138, 'learning_rate': 0.00011485714285714286, 'epoch': 21.43}
{'loss': 0.0393, 'grad_norm': 0.38681817054748535, 'learning_rate': 0.00011342857142857144, 'epoch': 21.79}
{'loss': 0.0481, 'grad_norm': 2.701477527618408, 'learning_rate': 0.00011200000000000001, 'epoch': 22.14}
{'loss': 0.0335, 'grad_norm': 0.40500161051750183, 'learning_rate': 0.00011057142857142857, 'epoch': 22.5}
{'loss': 0.0392, 'grad_norm': 0.2894068658351898, 'learning_rate': 0.00010914285714285715, 'epoch': 22.86}
{'loss': 0.0301, 'grad_norm': 0.2548198401927948, 'learning_rate': 0.00010771428571428572, 'epoch': 23.21}
{'loss': 0.0418, 'grad_norm': 0.32833537459373474, 'learning_rate': 0.0001062857142857143, 'epoch': 23.57}
{'loss': 0.0347, 'grad_norm': 0.9164894223213196, 'learning_rate': 0.00010485714285714285, 'epoch': 23.93}
{'loss': 0.0342, 'grad_norm': 0.3594805896282196, 'learning_rate': 0.00010342857142857143, 'epoch': 24.29}
{'loss': 0.0446, 'grad_norm': 3.8437740802764893, 'learning_rate': 0.00010200000000000001, 'epoch': 24.64}
{'loss': 0.05, 'grad_norm': 0.33201149106025696, 'learning_rate': 0.00010057142857142859, 'epoch': 25.0}
{'loss': 0.0322, 'grad_norm': 0.25483110547065735, 'learning_rate': 9.914285714285715e-05, 'epoch': 25.36}
{'loss': 0.0332, 'grad_norm': 1.851348876953125, 'learning_rate': 9.771428571428572e-05, 'epoch': 25.71}
{'loss': 0.0486, 'grad_norm': 0.6183315515518188, 'learning_rate': 9.628571428571429e-05, 'epoch': 26.07}
{'loss': 0.0398, 'grad_norm': 0.41881728172302246, 'learning_rate': 9.485714285714287e-05, 'epoch': 26.43}
{'loss': 0.032, 'grad_norm': 0.4816182553768158, 'learning_rate': 9.342857142857143e-05, 'epoch': 26.79}
{'loss': 0.043, 'grad_norm': 0.24050301313400269, 'learning_rate': 9.200000000000001e-05, 'epoch': 27.14}
{'loss': 0.0316, 'grad_norm': 0.4879654347896576, 'learning_rate': 9.057142857142857e-05, 'epoch': 27.5}
{'loss': 0.036, 'grad_norm': 0.581061601638794, 'learning_rate': 8.914285714285715e-05, 'epoch': 27.86}
{'loss': 0.0374, 'grad_norm': 0.447212815284729, 'learning_rate': 8.771428571428572e-05, 'epoch': 28.21}
{'loss': 0.0285, 'grad_norm': 0.3320792317390442, 'learning_rate': 8.62857142857143e-05, 'epoch': 28.57}
{'loss': 0.0348, 'grad_norm': 0.4239063858985901, 'learning_rate': 8.485714285714285e-05, 'epoch': 28.93}
{'loss': 0.0381, 'grad_norm': 0.3618786036968231, 'learning_rate': 8.342857142857143e-05, 'epoch': 29.29}
{'loss': 0.0388, 'grad_norm': 0.43612539768218994, 'learning_rate': 8.2e-05, 'epoch': 29.64}
{'loss': 0.0283, 'grad_norm': 0.4181082546710968, 'learning_rate': 8.057142857142857e-05, 'epoch': 30.0}
{'loss': 0.0381, 'grad_norm': 0.6173235774040222, 'learning_rate': 7.914285714285715e-05, 'epoch': 30.36}
{'loss': 0.0345, 'grad_norm': 0.2387808859348297, 'learning_rate': 7.771428571428572e-05, 'epoch': 30.71}
{'loss': 0.0254, 'grad_norm': 0.29995205998420715, 'learning_rate': 7.62857142857143e-05, 'epoch': 31.07}
{'loss': 0.0297, 'grad_norm': 0.23074401915073395, 'learning_rate': 7.485714285714285e-05, 'epoch': 31.43}
{'loss': 0.0292, 'grad_norm': 0.29228124022483826, 'learning_rate': 7.342857142857144e-05, 'epoch': 31.79}
{'loss': 0.0365, 'grad_norm': 0.3178788423538208, 'learning_rate': 7.2e-05, 'epoch': 32.14}
{'loss': 0.0242, 'grad_norm': 0.5782848596572876, 'learning_rate': 7.057142857142858e-05, 'epoch': 32.5}
{'loss': 0.0458, 'grad_norm': 0.44354867935180664, 'learning_rate': 6.914285714285715e-05, 'epoch': 32.86}
{'loss': 0.0346, 'grad_norm': 0.31050071120262146, 'learning_rate': 6.771428571428572e-05, 'epoch': 33.21}
{'loss': 0.0283, 'grad_norm': 0.33445990085601807, 'learning_rate': 6.628571428571428e-05, 'epoch': 33.57}
{'loss': 0.0367, 'grad_norm': 0.3128640651702881, 'learning_rate': 6.485714285714286e-05, 'epoch': 33.93}
{'loss': 0.0314, 'grad_norm': 0.4004517197608948, 'learning_rate': 6.342857142857143e-05, 'epoch': 34.29}
{'loss': 0.0311, 'grad_norm': 0.24606545269489288, 'learning_rate': 6.2e-05, 'epoch': 34.64}
{'loss': 0.0373, 'grad_norm': 0.4167073965072632, 'learning_rate': 6.0571428571428576e-05, 'epoch': 35.0}
{'loss': 0.031, 'grad_norm': 0.37668338418006897, 'learning_rate': 5.914285714285714e-05, 'epoch': 35.36}
{'loss': 0.0318, 'grad_norm': 0.2826905846595764, 'learning_rate': 5.771428571428572e-05, 'epoch': 35.71}
{'loss': 0.0381, 'grad_norm': 0.25632035732269287, 'learning_rate': 5.628571428571428e-05, 'epoch': 36.07}
{'loss': 0.0287, 'grad_norm': 0.27851271629333496, 'learning_rate': 5.485714285714286e-05, 'epoch': 36.43}
{'loss': 0.0305, 'grad_norm': 0.2792818248271942, 'learning_rate': 5.342857142857143e-05, 'epoch': 36.79}
{'loss': 0.0336, 'grad_norm': 0.40134963393211365, 'learning_rate': 5.2000000000000004e-05, 'epoch': 37.14}
{'loss': 0.0225, 'grad_norm': 0.34573599696159363, 'learning_rate': 5.057142857142857e-05, 'epoch': 37.5}
{'loss': 0.04, 'grad_norm': 0.5411015748977661, 'learning_rate': 4.9142857142857144e-05, 'epoch': 37.86}
{'loss': 0.0299, 'grad_norm': 0.26407474279403687, 'learning_rate': 4.771428571428572e-05, 'epoch': 38.21}
{'loss': 0.0352, 'grad_norm': 0.5147595405578613, 'learning_rate': 4.628571428571429e-05, 'epoch': 38.57}
{'loss': 0.0332, 'grad_norm': 0.23941335082054138, 'learning_rate': 4.485714285714286e-05, 'epoch': 38.93}
{'loss': 0.0304, 'grad_norm': 0.5478360652923584, 'learning_rate': 4.342857142857143e-05, 'epoch': 39.29}
{'loss': 0.0328, 'grad_norm': 0.3672635853290558, 'learning_rate': 4.2e-05, 'epoch': 39.64}
{'loss': 0.0327, 'grad_norm': 0.2361343801021576, 'learning_rate': 4.057142857142857e-05, 'epoch': 40.0}
{'loss': 0.0382, 'grad_norm': 0.23832646012306213, 'learning_rate': 3.9142857142857145e-05, 'epoch': 40.36}
{'loss': 0.0302, 'grad_norm': 0.46546149253845215, 'learning_rate': 3.771428571428572e-05, 'epoch': 40.71}
{'loss': 0.0271, 'grad_norm': 0.24843670427799225, 'learning_rate': 3.628571428571429e-05, 'epoch': 41.07}
{'loss': 0.0376, 'grad_norm': 0.4089043438434601, 'learning_rate': 3.485714285714286e-05, 'epoch': 41.43}
{'loss': 0.0284, 'grad_norm': 0.2867177128791809, 'learning_rate': 3.342857142857143e-05, 'epoch': 41.79}
{'loss': 0.0327, 'grad_norm': 0.2540700137615204, 'learning_rate': 3.2000000000000005e-05, 'epoch': 42.14}
{'loss': 0.0289, 'grad_norm': 0.36774197220802307, 'learning_rate': 3.057142857142857e-05, 'epoch': 42.5}
{'loss': 0.0305, 'grad_norm': 0.4348166584968567, 'learning_rate': 2.9142857142857146e-05, 'epoch': 42.86}
{'loss': 0.0239, 'grad_norm': 0.31705382466316223, 'learning_rate': 2.7714285714285716e-05, 'epoch': 43.21}
{'loss': 0.0311, 'grad_norm': 0.2475239336490631, 'learning_rate': 2.6285714285714286e-05, 'epoch': 43.57}
{'loss': 0.0385, 'grad_norm': 0.2340453565120697, 'learning_rate': 2.485714285714286e-05, 'epoch': 43.93}
{'loss': 0.0352, 'grad_norm': 0.316615492105484, 'learning_rate': 2.342857142857143e-05, 'epoch': 44.29}
{'loss': 0.0251, 'grad_norm': 0.26356688141822815, 'learning_rate': 2.2000000000000003e-05, 'epoch': 44.64}
{'loss': 0.0322, 'grad_norm': 0.24307183921337128, 'learning_rate': 2.0571428571428573e-05, 'epoch': 45.0}
{'loss': 0.0305, 'grad_norm': 0.41482028365135193, 'learning_rate': 1.9142857142857143e-05, 'epoch': 45.36}
{'loss': 0.0271, 'grad_norm': 0.2436496466398239, 'learning_rate': 1.7714285714285713e-05, 'epoch': 45.71}
{'loss': 0.0366, 'grad_norm': 0.32648977637290955, 'learning_rate': 1.6285714285714287e-05, 'epoch': 46.07}
{'loss': 0.0312, 'grad_norm': 0.2649155259132385, 'learning_rate': 1.4857142857142858e-05, 'epoch': 46.43}
{'loss': 0.0315, 'grad_norm': 0.2629775404930115, 'learning_rate': 1.3428571428571429e-05, 'epoch': 46.79}
{'loss': 0.0238, 'grad_norm': 0.23558013141155243, 'learning_rate': 1.2e-05, 'epoch': 47.14}
{'loss': 0.0357, 'grad_norm': 0.46655353903770447, 'learning_rate': 1.0571428571428572e-05, 'epoch': 47.5}
{'loss': 0.027, 'grad_norm': 0.3285616338253021, 'learning_rate': 9.142857142857144e-06, 'epoch': 47.86}
{'loss': 0.0331, 'grad_norm': 0.26413506269454956, 'learning_rate': 7.714285714285714e-06, 'epoch': 48.21}
{'loss': 0.039, 'grad_norm': 0.530576765537262, 'learning_rate': 6.285714285714287e-06, 'epoch': 48.57}
{'loss': 0.0229, 'grad_norm': 0.24360999464988708, 'learning_rate': 4.857142857142858e-06, 'epoch': 48.93}
{'loss': 0.0271, 'grad_norm': 0.4182901084423065, 'learning_rate': 3.428571428571429e-06, 'epoch': 49.29}
{'loss': 0.0285, 'grad_norm': 0.3322793245315552, 'learning_rate': 2.0000000000000003e-06, 'epoch': 49.64}
{'loss': 0.0358, 'grad_norm': 0.6253787279129028, 'learning_rate': 5.714285714285715e-07, 'epoch': 50.0}
{'train_runtime': 256.2398, 'train_samples_per_second': 5.464, 'train_steps_per_second': 5.464, 'train_loss': 0.15350332103669642, 'epoch': 50.0}
Saving model to models/small_model_lora
