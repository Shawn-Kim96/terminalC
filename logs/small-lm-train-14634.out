Loading model: data/model/meta-llama/llama-3.1-8B-instruct
Using device: cuda
trainable params: 13,631,488 || all params: 8,043,892,736 || trainable%: 0.1695
Loading dataset from data/training_data.jsonl
Starting training...
{'loss': 1.1068, 'grad_norm': 1.379515290260315, 'learning_rate': 0.0001982857142857143, 'epoch': 1.0}
{'loss': 0.3152, 'grad_norm': 1.5521959066390991, 'learning_rate': 0.0001962857142857143, 'epoch': 2.0}
{'loss': 0.1832, 'grad_norm': 4.0533552169799805, 'learning_rate': 0.0001942857142857143, 'epoch': 3.0}
{'loss': 0.1348, 'grad_norm': 0.9911263585090637, 'learning_rate': 0.00019228571428571428, 'epoch': 4.0}
{'loss': 0.1221, 'grad_norm': 2.411362409591675, 'learning_rate': 0.0001902857142857143, 'epoch': 5.0}
{'loss': 0.0896, 'grad_norm': 0.33493414521217346, 'learning_rate': 0.0001882857142857143, 'epoch': 6.0}
{'loss': 0.0712, 'grad_norm': 1.0156567096710205, 'learning_rate': 0.0001862857142857143, 'epoch': 7.0}
{'loss': 0.0678, 'grad_norm': 0.5944699645042419, 'learning_rate': 0.00018428571428571428, 'epoch': 8.0}
{'loss': 0.0471, 'grad_norm': 0.23004047572612762, 'learning_rate': 0.0001822857142857143, 'epoch': 9.0}
{'loss': 0.0478, 'grad_norm': 0.48896169662475586, 'learning_rate': 0.00018028571428571432, 'epoch': 10.0}
{'loss': 0.0422, 'grad_norm': 0.4183715581893921, 'learning_rate': 0.0001782857142857143, 'epoch': 11.0}
{'loss': 0.0363, 'grad_norm': 0.2230198085308075, 'learning_rate': 0.0001762857142857143, 'epoch': 12.0}
{'loss': 0.033, 'grad_norm': 0.333734929561615, 'learning_rate': 0.0001742857142857143, 'epoch': 13.0}
{'loss': 0.0286, 'grad_norm': 0.11078990250825882, 'learning_rate': 0.00017228571428571428, 'epoch': 14.0}
{'loss': 0.0216, 'grad_norm': 2.0730888843536377, 'learning_rate': 0.0001702857142857143, 'epoch': 15.0}
{'loss': 0.0279, 'grad_norm': 1.5132173299789429, 'learning_rate': 0.0001682857142857143, 'epoch': 16.0}
{'loss': 0.0222, 'grad_norm': 0.20945534110069275, 'learning_rate': 0.0001662857142857143, 'epoch': 17.0}
{'loss': 0.0175, 'grad_norm': 0.07957017421722412, 'learning_rate': 0.00016428571428571428, 'epoch': 18.0}
{'loss': 0.0218, 'grad_norm': 0.09874866157770157, 'learning_rate': 0.00016228571428571428, 'epoch': 19.0}
{'loss': 0.0253, 'grad_norm': 1.846554160118103, 'learning_rate': 0.0001602857142857143, 'epoch': 20.0}
{'loss': 0.0171, 'grad_norm': 0.1296280026435852, 'learning_rate': 0.0001582857142857143, 'epoch': 21.0}
{'loss': 0.0209, 'grad_norm': 0.2877492308616638, 'learning_rate': 0.0001562857142857143, 'epoch': 22.0}
{'loss': 0.0209, 'grad_norm': 0.5995025038719177, 'learning_rate': 0.0001542857142857143, 'epoch': 23.0}
{'loss': 0.0283, 'grad_norm': 0.39387762546539307, 'learning_rate': 0.00015228571428571429, 'epoch': 24.0}
{'loss': 0.0231, 'grad_norm': 0.867347776889801, 'learning_rate': 0.0001502857142857143, 'epoch': 25.0}
{'loss': 0.0289, 'grad_norm': 0.32841408252716064, 'learning_rate': 0.0001482857142857143, 'epoch': 26.0}
{'loss': 0.0181, 'grad_norm': 0.39329639077186584, 'learning_rate': 0.0001462857142857143, 'epoch': 27.0}
{'loss': 0.0161, 'grad_norm': 0.08161689341068268, 'learning_rate': 0.00014428571428571428, 'epoch': 28.0}
{'loss': 0.0192, 'grad_norm': 1.5767725706100464, 'learning_rate': 0.00014228571428571429, 'epoch': 29.0}
{'loss': 0.0199, 'grad_norm': 1.5704313516616821, 'learning_rate': 0.0001402857142857143, 'epoch': 30.0}
{'loss': 0.0261, 'grad_norm': 0.1551823616027832, 'learning_rate': 0.0001382857142857143, 'epoch': 31.0}
{'loss': 0.0205, 'grad_norm': 0.9423628449440002, 'learning_rate': 0.00013628571428571428, 'epoch': 32.0}
{'loss': 0.019, 'grad_norm': 2.7239856719970703, 'learning_rate': 0.00013428571428571428, 'epoch': 33.0}
{'loss': 0.0183, 'grad_norm': 0.1058865487575531, 'learning_rate': 0.00013228571428571431, 'epoch': 34.0}
{'loss': 0.0188, 'grad_norm': 0.12880073487758636, 'learning_rate': 0.0001302857142857143, 'epoch': 35.0}
{'loss': 0.0168, 'grad_norm': 0.07677759230136871, 'learning_rate': 0.0001282857142857143, 'epoch': 36.0}
{'loss': 0.0162, 'grad_norm': 0.3673321306705475, 'learning_rate': 0.0001262857142857143, 'epoch': 37.0}
{'loss': 0.0165, 'grad_norm': 0.12281722575426102, 'learning_rate': 0.00012428571428571428, 'epoch': 38.0}
{'loss': 0.0158, 'grad_norm': 0.8712815642356873, 'learning_rate': 0.0001222857142857143, 'epoch': 39.0}
{'loss': 0.0152, 'grad_norm': 0.12971501052379608, 'learning_rate': 0.0001202857142857143, 'epoch': 40.0}
{'loss': 0.0146, 'grad_norm': 0.0797107070684433, 'learning_rate': 0.00011828571428571429, 'epoch': 41.0}
{'loss': 0.0138, 'grad_norm': 0.14062881469726562, 'learning_rate': 0.00011628571428571429, 'epoch': 42.0}
{'loss': 0.0136, 'grad_norm': 0.10157206654548645, 'learning_rate': 0.00011428571428571428, 'epoch': 43.0}
{'loss': 0.0134, 'grad_norm': 0.08423401415348053, 'learning_rate': 0.00011228571428571429, 'epoch': 44.0}
{'loss': 0.0132, 'grad_norm': 0.0664016604423523, 'learning_rate': 0.00011028571428571428, 'epoch': 45.0}
{'loss': 0.0132, 'grad_norm': 0.07331433892250061, 'learning_rate': 0.0001082857142857143, 'epoch': 46.0}
{'loss': 0.0133, 'grad_norm': 0.14228661358356476, 'learning_rate': 0.0001062857142857143, 'epoch': 47.0}
{'loss': 0.0133, 'grad_norm': 0.09811025112867355, 'learning_rate': 0.0001042857142857143, 'epoch': 48.0}
{'loss': 0.0133, 'grad_norm': 0.10017375648021698, 'learning_rate': 0.00010228571428571429, 'epoch': 49.0}
{'loss': 0.0133, 'grad_norm': 0.1111748144030571, 'learning_rate': 0.0001002857142857143, 'epoch': 50.0}
{'loss': 0.0132, 'grad_norm': 0.07860620319843292, 'learning_rate': 9.828571428571429e-05, 'epoch': 51.0}
{'loss': 0.0133, 'grad_norm': 0.13639217615127563, 'learning_rate': 9.628571428571429e-05, 'epoch': 52.0}
{'loss': 0.0132, 'grad_norm': 0.07197287678718567, 'learning_rate': 9.428571428571429e-05, 'epoch': 53.0}
{'loss': 0.0132, 'grad_norm': 0.08078111708164215, 'learning_rate': 9.228571428571429e-05, 'epoch': 54.0}
{'loss': 0.0133, 'grad_norm': 0.06037772074341774, 'learning_rate': 9.028571428571428e-05, 'epoch': 55.0}
{'loss': 0.013, 'grad_norm': 0.06279369443655014, 'learning_rate': 8.828571428571429e-05, 'epoch': 56.0}
{'loss': 0.0131, 'grad_norm': 0.08892662823200226, 'learning_rate': 8.62857142857143e-05, 'epoch': 57.0}
{'loss': 0.013, 'grad_norm': 0.06003052368760109, 'learning_rate': 8.428571428571429e-05, 'epoch': 58.0}
{'loss': 0.0131, 'grad_norm': 0.10158271342515945, 'learning_rate': 8.228571428571429e-05, 'epoch': 59.0}
{'loss': 0.0131, 'grad_norm': 0.05903895944356918, 'learning_rate': 8.028571428571428e-05, 'epoch': 60.0}
{'loss': 0.013, 'grad_norm': 0.05913706123828888, 'learning_rate': 7.828571428571429e-05, 'epoch': 61.0}
{'loss': 0.013, 'grad_norm': 0.0541815347969532, 'learning_rate': 7.62857142857143e-05, 'epoch': 62.0}
{'loss': 0.0131, 'grad_norm': 0.06375985592603683, 'learning_rate': 7.428571428571429e-05, 'epoch': 63.0}
{'loss': 0.013, 'grad_norm': 0.07630527019500732, 'learning_rate': 7.228571428571429e-05, 'epoch': 64.0}
{'loss': 0.0129, 'grad_norm': 0.054770488291978836, 'learning_rate': 7.028571428571428e-05, 'epoch': 65.0}
{'loss': 0.0129, 'grad_norm': 0.06733717769384384, 'learning_rate': 6.828571428571429e-05, 'epoch': 66.0}
{'loss': 0.0129, 'grad_norm': 0.06031017377972603, 'learning_rate': 6.628571428571428e-05, 'epoch': 67.0}
{'loss': 0.0129, 'grad_norm': 0.060826096683740616, 'learning_rate': 6.428571428571429e-05, 'epoch': 68.0}
{'loss': 0.0129, 'grad_norm': 0.05372270941734314, 'learning_rate': 6.22857142857143e-05, 'epoch': 69.0}
{'loss': 0.0129, 'grad_norm': 0.06356383860111237, 'learning_rate': 6.028571428571429e-05, 'epoch': 70.0}
{'loss': 0.0128, 'grad_norm': 0.06503619998693466, 'learning_rate': 5.828571428571429e-05, 'epoch': 71.0}
{'loss': 0.0128, 'grad_norm': 0.06522633880376816, 'learning_rate': 5.628571428571428e-05, 'epoch': 72.0}
{'loss': 0.0128, 'grad_norm': 0.06731089949607849, 'learning_rate': 5.428571428571428e-05, 'epoch': 73.0}
{'loss': 0.0129, 'grad_norm': 0.07181072980165482, 'learning_rate': 5.2285714285714294e-05, 'epoch': 74.0}
{'loss': 0.0127, 'grad_norm': 0.0665879175066948, 'learning_rate': 5.028571428571429e-05, 'epoch': 75.0}
{'loss': 0.0128, 'grad_norm': 0.0621301606297493, 'learning_rate': 4.828571428571429e-05, 'epoch': 76.0}
{'loss': 0.0128, 'grad_norm': 0.09625270962715149, 'learning_rate': 4.628571428571429e-05, 'epoch': 77.0}
{'loss': 0.0129, 'grad_norm': 0.09483929723501205, 'learning_rate': 4.428571428571428e-05, 'epoch': 78.0}
{'loss': 0.0128, 'grad_norm': 0.09121212363243103, 'learning_rate': 4.228571428571429e-05, 'epoch': 79.0}
{'loss': 0.0128, 'grad_norm': 0.0550214983522892, 'learning_rate': 4.028571428571429e-05, 'epoch': 80.0}
{'loss': 0.0127, 'grad_norm': 0.0611247755587101, 'learning_rate': 3.8285714285714286e-05, 'epoch': 81.0}
{'loss': 0.0127, 'grad_norm': 0.0639447495341301, 'learning_rate': 3.628571428571429e-05, 'epoch': 82.0}
{'loss': 0.0127, 'grad_norm': 0.06773637235164642, 'learning_rate': 3.428571428571429e-05, 'epoch': 83.0}
{'loss': 0.0126, 'grad_norm': 0.0607263520359993, 'learning_rate': 3.228571428571428e-05, 'epoch': 84.0}
{'loss': 0.0127, 'grad_norm': 0.08104084432125092, 'learning_rate': 3.0285714285714288e-05, 'epoch': 85.0}
{'loss': 0.0126, 'grad_norm': 0.06699997186660767, 'learning_rate': 2.8285714285714287e-05, 'epoch': 86.0}
{'loss': 0.0127, 'grad_norm': 0.08846428245306015, 'learning_rate': 2.6285714285714286e-05, 'epoch': 87.0}
{'loss': 0.0126, 'grad_norm': 0.13469655811786652, 'learning_rate': 2.4285714285714288e-05, 'epoch': 88.0}
{'loss': 0.0126, 'grad_norm': 0.0825846791267395, 'learning_rate': 2.2285714285714287e-05, 'epoch': 89.0}
{'loss': 0.0126, 'grad_norm': 0.09054974466562271, 'learning_rate': 2.0285714285714286e-05, 'epoch': 90.0}
{'loss': 0.0125, 'grad_norm': 0.059694401919841766, 'learning_rate': 1.8285714285714288e-05, 'epoch': 91.0}
{'loss': 0.0125, 'grad_norm': 0.06218696013092995, 'learning_rate': 1.6285714285714287e-05, 'epoch': 92.0}
{'loss': 0.0125, 'grad_norm': 0.06839162856340408, 'learning_rate': 1.4285714285714285e-05, 'epoch': 93.0}
{'loss': 0.0125, 'grad_norm': 0.08742166310548782, 'learning_rate': 1.2285714285714286e-05, 'epoch': 94.0}
{'loss': 0.0124, 'grad_norm': 0.0638337954878807, 'learning_rate': 1.0285714285714286e-05, 'epoch': 95.0}
{'loss': 0.0124, 'grad_norm': 0.08257587999105453, 'learning_rate': 8.285714285714285e-06, 'epoch': 96.0}
{'loss': 0.0124, 'grad_norm': 0.06830806285142899, 'learning_rate': 6.285714285714287e-06, 'epoch': 97.0}
{'loss': 0.0124, 'grad_norm': 0.06343751400709152, 'learning_rate': 4.285714285714286e-06, 'epoch': 98.0}
{'loss': 0.0123, 'grad_norm': 0.13360342383384705, 'learning_rate': 2.285714285714286e-06, 'epoch': 99.0}
{'loss': 0.0123, 'grad_norm': 0.08418445289134979, 'learning_rate': 2.8571428571428575e-07, 'epoch': 100.0}
{'train_runtime': 730.6187, 'train_samples_per_second': 3.832, 'train_steps_per_second': 3.832, 'train_loss': 0.036322395013911386, 'epoch': 100.0}
Saving model to models/small_model_lora
